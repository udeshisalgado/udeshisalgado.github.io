<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.36">

  <title>Udeshi Salgado – dl4sg_slides</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-fc50a1660a49e0b365f3020b91fa9cc4.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Udeshi Salgado">
<meta property="og:site_name" content="Udeshi Salgado">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="introduction-to-continuous-markov-chains-queueing-theory-in-healthcare-supply-chains" class="slide level2 title-slide center" data-background-image="images/background.png" data-background-size="cover">
<h2>Introduction to Continuous <br>Markov Chains &amp; Queueing Theory <br>in Healthcare Supply Chains</h2>
<p><br><br><br></p>
<p><strong>Udeshi Salgado</strong><br>
<em>Data Lab for Social Good,</em> <br> <em>Cardiff University, UK</em><br>
2025-05-15</p>
</section>
<section id="assumptions" class="slide level2">
<h2>Assumptions</h2>
<ul>
<li>You should be familiar with basic probability and random variables.</li>
<li>You are expected to be comfortable with R (or Python) for basic simulation and matrix operations.</li>
<li>This is not a theory-heavy workshop—we will use simple examples to build intuition, not derive theorems.</li>
</ul>
</section>
<section id="what-we-will-cover" class="slide level2">
<h2>What We Will Cover</h2>
<ul>
<li>Key concepts and steady-state analysis of Continuous-Time Markov Chains (CTMCs)<br>
</li>
<li>Modeling a vaccine observation room using CTMCs</li>
<li>Introduction to Queueing Theory</li>
<li>Introduction to M/M/1 queueing systems and performance metrics</li>
</ul>
</section>
<section id="what-we-will-not-cover" class="slide level2">
<h2>What We Will <em>Not</em> Cover</h2>
<ul>
<li>Theoretical proofs (e.g., Chapman-Kolmogorov, Little’s Law)<br>
</li>
<li>Networks of queues</li>
<li>Multiclass queues and priority scheduling<br>
</li>
<li>Non-stationary arrivals and general service times</li>
<li>Non-exponential queues</li>
<li>Time-dependent queueing models</li>
</ul>
</section>
<section id="materials" class="slide level2">
<h2>Materials</h2>
<ul>
<li>You can find the workshop materials at here.</li>
<li>Note: These materials are based on my learnings at <a href="https://www.natcor.ac.uk/courses/">NATCOR Taught Course Centre: Stochastic Modelling Course</a></li>
</ul>
</section>
<section>
<section id="outline" class="title-slide slide level1 center">
<h1><span style="color: black;">Outline</span></h1>
<ol type="1">
<li><span style="color: red;">Recap</span></li>
<li>Continuous Time Markov Chains (CTMC)</li>
<li>Queueing Theory</li>
<li>Lab Activity: Vaccine Clinic Operations</li>
</ol>
</section>
<section id="recap-assumptions" class="slide level2">
<h2>Recap: Assumptions</h2>
<ul>
<li>The Markov chain is in exactly one state at any particular time step.</li>
<li>The probability distribution for the next state only depends on the current state (Markov property).</li>
<li>The transition probabilities are the same on every time step.</li>
</ul>
</section>
<section id="recap-discrete-mc-vs-continuous-mc" class="slide level2">
<h2>Recap: Discrete MC Vs Continuous MC</h2>

<img data-src="images/discretevscontinuous.png" class="r-stretch"></section></section>
<section>
<section id="outline-1" class="title-slide slide level1 center">
<h1><span style="color: black;">Outline</span></h1>
<ol type="1">
<li>Recap</li>
<li><span style="color: red;">Continuous Time Markov Chains (CTMC)</span></li>
<li>Queueing Theory</li>
<li>Lab Activity: Vaccine Clinic Operations</li>
</ol>
</section>
<section id="continuous-time-markov-chains-ctmc" class="slide level2">
<h2>Continuous Time Markov Chains (CTMC)</h2>
<ul>
<li>In a continuous-time Markov chain (CTMC), the system state can change at any point on the continuous time axis.</li>
</ul>

<img data-src="images/ctmc.png" class="r-stretch"></section>
<section id="exponential-timing-in-ctmcs" class="slide level2">
<h2>Exponential Timing in CTMCs</h2>
<ul>
<li><strong>Assumption</strong>: Time until the next transition follows an <strong>Exponential(λ)</strong> distribution, where <strong>λ is the transition rate</strong> (higher λ → shorter expected time between transitions)</li>
<li><strong>Memoryless Property</strong>:<br>
<span class="math display">\[
  \Pr(X &gt; t + u \mid X &gt; u) = \Pr(X &gt; t) \]</span></li>
<li>Past time in a state doesn’t affect future transitions</li>
<li>Transition probability depends only on the <strong>current state</strong> → <strong>Markov property</strong></li>
</ul>
</section>
<section id="ctmcs-definition" class="slide level2">
<h2>CTMCs: Definition</h2>
<blockquote>
<p><strong>A continuous-time Markov chain</strong> is a stochastic process</p>
<p><span class="math display">\[
\{X(t) \mid t \geq 0\}
\]</span></p>
<p>in which the probability of some future event (say ( A )) depends <strong>only</strong> on the <strong>current state</strong>, not on past states.</p>
<p>Formally:</p>
<p><span class="math display">\[
\Pr(A \mid X(t),\, 0 \leq t \leq T) = \Pr(A \mid X(T))
\]</span></p>
</blockquote>
<p>As in the discrete-time case, the key idea is: <strong>future behavior depends only on the current state</strong>.</p>
</section>
<section id="ctmc-example-managing-a-tiny-shops-flow" class="slide level2">
<h2>CTMC Example: Managing a Tiny Shop’s Flow</h2>
<p>Imagine a <strong>small neighborhood pharmacy</strong> with space for <strong>maximum of two customers at a time</strong>. As the shop owner, you’re analyzing foot traffic to optimize customer experience without overcrowding or turning people away.</p>

<img data-src="images/ctmc_example.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="ctmc-example-managing-a-tiny-shops-flow-cont." class="slide level2">
<h2>CTMC Example: Managing a Tiny Shop’s Flow Cont.</h2>
<ul>
<li><strong>Arrivals</strong> follow an exponential distribution with <strong>λ = 1 per minute</strong></li>
<li><strong>Departures</strong> depend on how many customers are in the shop:
<ul>
<li><strong>1 customer</strong> → exponential(λ = 0.25)</li>
<li><strong>2 customers</strong> → exponential(λ = 0.5)</li>
</ul></li>
<li>If a new customer arrives:
<ul>
<li>And there are <strong>0 or 1 customers</strong>, they enter the shop</li>
<li>If <strong>2 customers</strong> are already inside, they <strong>leave without entering</strong> (no queueing!)</li>
</ul></li>
</ul>
</section>
<section id="ctmc-example-transition-rate-diagram" class="slide level2">
<h2>CTMC Example: Transition Rate Diagram</h2>
<ul>
<li>We can model this scenario as a <strong>Continuous-Time Markov Chain (CTMC)</strong>, where the <strong>state</strong> represents the <strong>number of customers in the shop</strong>.</li>
<li>Thus, the possible states are: <code>0</code>, <code>1</code>, and <code>2</code>.</li>
<li>We can visualize the <strong>transition rates</strong> between these states:</li>
</ul>

<img data-src="images/ctmc_transition_diagram.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="time-until-next-transition" class="slide level2">
<h2>Time Until Next Transition</h2>
<p>Let <span class="math inline">\(T_i\)</span> be the time until the next transition from state <span class="math inline">\(i \in \{0, 1, 2\}\)</span></p>
<ul>
<li><p><span class="math inline">\(T_0 \sim \text{Exp}(1)\)</span> <em>(arrival triggers transition)</em></p></li>
<li><p><span class="math inline">\(T_2 \sim \text{Exp}(0.5)\)</span> <em>(departure triggers transition)</em></p></li>
<li><p><span class="math inline">\(T_1 = \min(A, D)\)</span>, where:</p>
<ul>
<li><span class="math inline">\(A \sim \text{Exp}(1)\)</span> <em>(a new customer arrives)</em></li>
<li><span class="math inline">\(D \sim \text{Exp}(0.25)\)</span> <em>(a customer leaves the shop)</em></li>
</ul></li>
</ul>
</section>
<section id="exponential-minimum-property" class="slide level2">
<h2>Exponential Minimum Property</h2>
<p>Suppose <span class="math inline">\(T_1\)</span>, <span class="math inline">\(T_2\)</span> are independent and <span class="math display">\[
T_1 \sim \text{Exp}(\lambda_1),\quad T_2 \sim \text{Exp}(\lambda_2)
\]</span></p>
<p>Then:<br>
<span class="math display">\[
\min(T_1, T_2) \sim \text{Exp}(\lambda_1 + \lambda_2)
\]</span></p>
</section>
<section id="exponential-minimum-property-cont." class="slide level2">
<h2>Exponential Minimum Property Cont.</h2>
<p><strong>Application to our example:</strong></p>
<ul>
<li>For state 1:<br>
<span class="math display">\[
T_1 = \min(A, D); \quad A \sim \text{Exp}(1),\ D \sim \text{Exp}(0.25)
\]</span></li>
<li>So:<br>
<span class="math display">\[
T_1 \sim \text{Exp}(1 + 0.25) = \text{Exp}(1.25)
\]</span></li>
</ul>
</section>
<section id="generator-matrix-for-a-ctmc" class="slide level2">
<h2>Generator Matrix for a CTMC</h2>
<p>The <strong>generator matrix (Q)</strong> summarizes the transition rates between states in a CTMC.</p>
<ul>
<li>Each element <span class="math inline">\(q_{ij}\)</span> gives the <strong>rate of moving from state <span class="math inline">\(i\)</span> to state <span class="math inline">\(j\)</span></strong></li>
<li><strong>Diagonal elements</strong> are negative and equal to the <strong>negative of the row sum</strong></li>
<li><strong>Non-diagonal elements</strong> are <span class="math inline">\(\geq 0\)</span> and indicate direct transitions</li>
</ul>
</section>
<section id="interpreting-key-entries-in-generator-matrix" class="slide level2">
<h2>Interpreting Key Entries in Generator Matrix</h2>

<img data-src="images/generator_matrix.png" style="width:100.0%" class="r-stretch"></section>
<section id="steady-state-probabilities" class="slide level2">
<h2>Steady-State Probabilities</h2>
<p><strong>Steady-state probabilities</strong> represent the long-run behavior of the system.<br>
They tell us:</p>
<ul>
<li>The <strong>proportion of time</strong> the CTMC spends in each state in the long run.</li>
<li>The <strong>limiting probability</strong> that the system is in a given state after a long time.</li>
</ul>
<p>To find them, we solve: <span class="math display">\[
\boldsymbol{\pi} \mathbf{Q} = \mathbf{0}, \quad \text{with} \quad \sum \pi_i = 1
\]</span></p>
</section>
<section id="solving-the-system" class="slide level2">
<h2>Solving the System</h2>
<p>From:</p>
<ul>
<li><span class="math inline">\(-\pi_0 + 0.25\pi_1 = 0 \Rightarrow \pi_1 = 4\pi_0\)</span></li>
<li><span class="math inline">\(\pi_1 - 0.5\pi_2 = 0 \Rightarrow \pi_2 = 2\pi_1 = 8\pi_0\)</span></li>
<li><span class="math inline">\(\pi_0 + 4\pi_0 + 8\pi_0 = 13\pi_0 = 1 \Rightarrow \pi_0 = \frac{1}{13}\)</span></li>
</ul>
<p>Thus: <span class="math display">\[
\pi_0 = \frac{1}{13},\quad \pi_1 = \frac{4}{13},\quad \pi_2 = \frac{8}{13}
\]</span></p>
</section>
<section id="long-run-average-number-of-customers" class="slide level2">
<h2>Long-run Average Number of Customers</h2>
<p>We calculate:</p>
<p><span class="math display">\[
0 \cdot \frac{1}{13} + 1 \cdot \frac{4}{13} + 2 \cdot \frac{8}{13} = \frac{20}{13} \approx 1.54
\]</span></p>
<p>This is the expected number of customers in the shop in the long run.</p>
</section>
<section id="summary-of-ctmcs" class="slide level2">
<h2>Summary of CTMCs</h2>
<ul>
<li>Transition times are exponentially distributed.</li>
<li>The <strong>generator matrix <span class="math inline">\(\mathbf{Q}\)</span></strong> defines transition rates.</li>
<li>Steady-state <span class="math inline">\(\boldsymbol{\pi}\)</span> solves:<br>
<span class="math display">\[
  \boldsymbol{\pi} \mathbf{Q} = 0, \quad \sum \pi_i = 1
  \]</span></li>
<li><span class="math inline">\(\pi_i\)</span> gives long-run proportions of time spent in each state.</li>
</ul>
</section>
<section id="queueing-systems-as-ctmcs" class="slide level2">
<h2>Queueing Systems as CTMCs</h2>
<p>A queueing system (e.g., customer service desk, call center, clinic) can often be modeled as a <strong>continuous-time Markov chain</strong>, under assumptions like:</p>
<ul>
<li>Exponentially-distributed inter-arrival times</li>
<li>Exponentially-distributed service times</li>
<li>Finite waiting area, single server, and one-at-a-time processing</li>
</ul>

<img data-src="images/queueing_ctmc.png" style="width:80.0%" class="r-stretch"></section></section>
<section>
<section id="outline-2" class="title-slide slide level1 center">
<h1><span style="color: black;">Outline</span></h1>
<ol type="1">
<li>Recap</li>
<li>Continuous Time Markov Chains (CTMC)</li>
<li><span style="color: red;">Queueing Theory</span></li>
<li>Lab Activity: Vaccine Clinic Operations</li>
</ol>
</section>
<section id="queueing-theory" class="slide level2">
<h2>Queueing Theory</h2>
<p><br> <br> Welcome to Queueing Theory!<br>
We’ll explore how to model and analyze systems where “waiting” happens — like hospitals, call centers, and shops.</p>
</section>
<section id="what-is-a-queueing-system" class="slide level2">
<h2>What is a Queueing System?</h2>
<p>A system with:</p>
<ul>
<li><strong>Arrivals</strong> (e.g., customers, calls)</li>
<li><strong>A queue</strong> (optional)</li>
<li><strong>Service process</strong> (1 or more servers)</li>
<li><strong>Departures</strong></li>
</ul>

<img data-src="images/queing_basic.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="real-world-applications" class="slide level2">
<h2>Real-World Applications</h2>
<ul>
<li>ATM and supermarket checkout lines</li>
<li>Call centers and helpdesks</li>
<li>Hospital patient flow</li>
<li>Computer servers and networks</li>
</ul>
</section>
<section id="kendalls-standard-notation" class="slide level2">
<h2>Kendall’s Standard Notation</h2>
<p>Queueing systems are described using: <strong>A/B/S/d/e</strong></p>
<ul>
<li><strong>A</strong> – Arrival distribution (e.g., M = Exponential)</li>
<li><strong>B</strong> – Service distribution (e.g., M, D = Deterministic, G = General)</li>
<li><strong>S</strong> – Number of servers</li>
<li><strong>d</strong> – System capacity (buffer size)</li>
<li><strong>e</strong> – Queue discipline (e.g., FIFO, LIFO)</li>
</ul>
<p><strong>Example: M/M/2/5/FIFO</strong></p>
<p>→ Exponential arrivals, exponential service, 2 servers,<br>
→ Max 5 customers in system, served in order of arrival</p>
</section>
<section id="poisson-process" class="slide level2">
<h2>Poisson Process</h2>
<ul>
<li>Many queueing systems assume <strong>Poisson arrivals</strong>, a key foundation for M/M/1 and related models.</li>
<li>This process is simple but powerful and forms the basis for most queueing models.</li>
</ul>
<p><strong>Definition:</strong><br>
A Poisson process with rate <span class="math inline">\(\lambda\)</span> models <strong>random arrivals over time</strong>, where:</p>

<img data-src="images/poisson_process.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section id="poisson-process-cont." class="slide level2">
<h2>Poisson Process Cont.</h2>
<ul>
<li>The number of arrivals in time <span class="math inline">\(t\)</span> follows:<br>
<span class="math display">\[
P(N(t) = k) = \frac{(\lambda t)^k e^{-\lambda t}}{k!}
\]</span></li>
<li><strong>Interarrival times</strong> are exponentially distributed:<br>
<span class="math display">\[
T \sim \text{Exp}(\lambda)
\]</span></li>
<li><strong>Memoryless</strong>: the probability of arrival doesn’t depend on the past</li>
</ul>
</section>
<section id="the-mm1-queue" class="slide level2">
<h2>The M/M/1 Queue</h2>

<img data-src="images/mm1.png" class="quarto-figure quarto-figure-center r-stretch"><ul>
<li>A single-server queue with:
<ul>
<li><strong>Exponential interarrival times</strong> (rate <span class="math inline">\(\lambda\)</span>)</li>
<li><strong>Exponential service times</strong> (rate <span class="math inline">\(\mu\)</span>)</li>
</ul></li>
<li>The number of customers in the system defines the <strong>state</strong></li>
<li>The queue has <strong>infinite capacity</strong></li>
</ul>
</section>
<section id="the-mm1-queue-cont." class="slide level2">
<h2>The M/M/1 Queue Cont.</h2>
<p><strong>Traffic intensity:</strong><br>
<span class="math display">\[
\rho = \frac{\lambda}{\mu}
\]</span></p>
<ul>
<li>If <span class="math inline">\(\rho &lt; 1\)</span>, the system reaches a <strong>steady-state</strong></li>
<li>If <span class="math inline">\(\rho \geq 1\)</span>, the queue grows indefinitely</li>
<li><span class="math inline">\(\lambda\)</span> = arrival rate, <span class="math inline">\(\mu\)</span> = service rate</li>
</ul>
<p>💡 Think of <span class="math inline">\(\rho\)</span> as the <strong>load</strong> on the server.<br>
If arrivals outpace service, the system can’t cope.</p>
</section>
<section id="mm1-as-a-ctmc" class="slide level2">
<h2>M/M/1 as a CTMC</h2>
<ul>
<li><p>The M/M/1 queue can be modeled as a <strong>Continuous-Time Markov Chain (CTMC)</strong> with <strong>states</strong> representing the number of customers in the system.</p></li>
<li><p>It forms a <strong>birth-death process</strong>:</p>
<ul>
<li><strong>Arrivals (births)</strong> at rate <span class="math inline">\(\lambda\)</span></li>
<li><strong>Departures (deaths)</strong> at rate <span class="math inline">\(\mu\)</span></li>
</ul></li>
</ul>
</section>
<section id="mm1-as-a-ctmc-cont." class="slide level2">
<h2>M/M/1 as a CTMC Cont.</h2>
<p><strong>Generator matrix (Q):</strong></p>
<p><span class="math display">\[
\mathbf{Q} =
\begin{pmatrix}
-\lambda &amp; \lambda &amp; 0 &amp; 0 &amp; \cdots \\
\mu &amp; -(\lambda + \mu) &amp; \lambda &amp; 0 &amp; \cdots \\
0 &amp; \mu &amp; -(\lambda + \mu) &amp; \lambda &amp; \cdots \\
\vdots &amp; \vdots &amp; \ddots &amp; \ddots &amp; \ddots
\end{pmatrix}
\]</span></p>
<ul>
<li>This structure defines the dynamics of the queue over time.</li>
</ul>
</section>
<section id="mm1-stationary-distribution-performance" class="slide level2">
<h2>M/M/1: Stationary Distribution &amp; Performance</h2>
<p>With steady-state probabilities <span class="math inline">\(\{p_n,\ n \geq 0\}\)</span>:</p>
<ul>
<li>Probability the system is <strong>empty</strong> <span class="math display">\[
  p_0 = 1 - \rho
  \]</span></li>
<li>Probability the <strong>server is busy</strong> <span class="math display">\[
  1 - p_0 = \rho
  \]</span></li>
<li>Probability of <strong><span class="math inline">\(n\)</span> customers</strong> in the system <span class="math display">\[
  p_n = \rho^n (1 - \rho)
  \]</span></li>
</ul>
</section>
<section id="mm1-stationary-distribution-performance-cont." class="slide level2">
<h2>M/M/1: Stationary Distribution &amp; Performance Cont.</h2>
<p><strong>Mean number of customers in the system (L):</strong></p>
<p><span class="math display">\[
L = \sum_{n=0}^\infty n p_n
= (1 - \rho) \sum_{n=0}^\infty n \rho^n
= \frac{\rho}{1 - \rho}
\]</span></p>
<p>This is one of the key performance metrics in queueing theory.</p>
</section>
<section id="performance-measures-in-queueing" class="slide level2">
<h2>Performance Measures in Queueing</h2>
<p>Four key summary performance measures:</p>
<ul>
<li><strong><span class="math inline">\(L\)</span></strong>: Mean number of customers <strong>in the system</strong></li>
<li><strong><span class="math inline">\(L_q\)</span></strong>: Mean number of customers <strong>in the queue</strong></li>
<li><strong><span class="math inline">\(W\)</span></strong>: Mean time a customer spends <strong>in the system</strong></li>
<li><strong><span class="math inline">\(W_q\)</span></strong>: Mean time a customer spends <strong>waiting in the queue</strong></li>
</ul>
</section>
<section id="littles-law" class="slide level2">
<h2>Little’s Law</h2>
<p>A fundamental relationship linking <strong>arrival rate</strong>, <strong>waiting time</strong>, and <strong>number in the system</strong>.</p>
<p>Relates these measures:</p>
<p><span class="math display">\[
L = \lambda W,\quad L_q = \lambda W_q
\]</span></p>
<p>Also:</p>
<p><span class="math display">\[
W = W_q + \frac{1}{\mu},\quad L = L_q + \frac{\lambda}{\mu}
\]</span></p>
</section>
<section id="mm1-queue-performance-formulas" class="slide level2">
<h2>M/M/1 Queue: Performance Formulas</h2>
<p>Using <span class="math inline">\(\rho = \frac{\lambda}{\mu}\)</span> and Little’s Law:</p>
<ul>
<li><p>Mean number in the system: <span class="math display">\[
L = \frac{\rho}{1 - \rho}
\]</span></p></li>
<li><p>Mean number in queue: <span class="math display">\[
L_q = \frac{\rho^2}{1 - \rho}
\]</span></p></li>
</ul>
</section>
<section id="mm1-queue-performance-formulas-cont." class="slide level2">
<h2>M/M/1 Queue: Performance Formulas Cont.</h2>
<ul>
<li><p>Mean time in the system: <span class="math display">\[
W = \frac{1}{\mu(1 - \rho)}
\]</span></p></li>
<li><p>Mean waiting time in queue: <span class="math display">\[
W_q = \frac{\rho}{\mu(1 - \rho)}
\]</span></p></li>
</ul>
</section>
<section id="comparing-mm1-mms-and-mmsb" class="slide level2">
<h2>Comparing M/M/1, M/M/s, and M/M/s/b</h2>
<style>
table {
  font-size: 65%;
  width: 100%;
  border-collapse: collapse;
  border: 1px solid #ccc;
}
th {
  background-color: #dbeafe; /* light blue */
  padding: 8px;
  text-align: center;
  border: 1px solid #ccc;
}
td {
  padding: 8px;
  text-align: center;
  border: 1px solid #ccc;
}
tr:last-child td {
  border-bottom: 2px solid #000; /* darker line after last row */
}
</style>
<table class="caption-top">
<colgroup>
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 28%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>M/M/1</th>
<th>M/M/s</th>
<th>M/M/s/b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Servers</td>
<td>1</td>
<td><span class="math inline">\(s\)</span></td>
<td><span class="math inline">\(s\)</span></td>
</tr>
<tr class="even">
<td>System Capacity</td>
<td>Infinite</td>
<td>Infinite</td>
<td><span class="math inline">\(b\)</span> (finite)</td>
</tr>
<tr class="odd">
<td>Arrival Rate (<span class="math inline">\(\lambda\)</span>)</td>
<td>Poisson</td>
<td>Poisson</td>
<td>Poisson</td>
</tr>
<tr class="even">
<td>Service Time</td>
<td>Exponential</td>
<td>Exponential</td>
<td>Exponential</td>
</tr>
<tr class="odd">
<td>Queue Capacity</td>
<td>Infinite</td>
<td>Infinite</td>
<td><span class="math inline">\(b - s\)</span></td>
</tr>
<tr class="even">
<td>Blocking?</td>
<td>No</td>
<td>No</td>
<td>Yes (if system full)</td>
</tr>
<tr class="odd">
<td>Common Use</td>
<td>Basic single-server queue</td>
<td>Multi-server (e.g., call center)</td>
<td>Limited capacity (e.g., hospital beds)</td>
</tr>
</tbody>
</table>
</section>
<section id="lets-practice-model-matching" class="slide level2">
<h2>Let’s Practice: Model Matching</h2>
<p>You’ll see 3 real-world situations.<br>
For each one, pick the <strong>most suitable queueing model</strong>:</p>
<ul>
<li>M/M/1</li>
<li>M/M/s</li>
<li>M/M/s/b</li>
</ul>
<p>You’ll have <strong>30 seconds</strong> to discuss or decide for each!</p>
<script>
let timerIntervals = {};

function startTimer(buttonId, seconds = 60) {
  const btn = document.getElementById(buttonId);
  if (!btn || isNaN(seconds)) return;

  clearInterval(timerIntervals[buttonId]); // clear any existing timer

  let count = parseInt(seconds, 10); // ensure it's a number
  const tick = () => {
    if (count < 0) {
      clearInterval(timerIntervals[buttonId]);
      btn.innerHTML = "⏰";
      return;
    }
    const mins = String(Math.floor(count / 60)).padStart(2, '0');
    const secs = String(count % 60).padStart(2, '0');
    btn.innerHTML = `⏳ ${mins}:${secs}`;
    count--;
  };

  tick(); // show first value immediately
  timerIntervals[buttonId] = setInterval(tick, 1000);
}
</script>
</section>
<section id="scenario-1" class="slide level2">
<h2>Scenario 1</h2>
<p>An emergency care unit in a district hospital has five treatment beds. Once all beds are occupied, incoming patients must be transferred to a different facility, as there is no space for waiting or holding.</p>
<p>Which queueing model applies?</p>
<ul>
<li>M/M/1<br>
</li>
<li>M/M/s<br>
</li>
<li>M/M/s/b</li>
</ul>
<button id="timer-btn-1" onclick="startTimer('timer-btn-1', 30)" style="
  position: absolute;
  bottom: 1em;
  right: 2em;
  padding: 12px 18px;
  font-size: 1.2em;
  font-weight: bold;
  border-radius: 8px;
  border: 2px solid #ccc;
  background-color: #f9f9f9;
  color: #333;
  font-family: monospace;
">
⏳ 00:30
</button>
</section>
<section id="scenario-1-answer" class="slide level2">
<h2>Scenario 1 – Answer</h2>
<p><br><br> <span style="color: red;"><strong>M/M/s/b Queueing Model</strong> </span><br>
<br> - Multiple beds = multiple servers<br>
- No waiting space = limited capacity<br>
- Incoming patients are blocked if full</p>
</section>
<section id="scenario-2" class="slide level2">
<h2>Scenario 2</h2>
<p>A mobile vaccination clinic is staffed by a single nurse. Patients from a rural community arrive randomly and are vaccinated one at a time. If the nurse is busy, others wait in line without any restrictions on queue length.</p>
<p>Which model applies?</p>
<ul>
<li>M/M/1<br>
</li>
<li>M/M/s<br>
</li>
<li>M/M/s/b</li>
</ul>
<button id="timer-btn-2" onclick="startTimer('timer-btn-2', 30)" style="
  position: absolute;
  bottom: 1em;
  right: 2em;
  padding: 12px 18px;
  font-size: 1.2em;
  font-weight: bold;
  border-radius: 8px;
  border: 2px solid #ccc;
  background-color: #f9f9f9;
  color: #333;
  font-family: monospace;
">
⏳ 00:30
</button>
</section>
<section id="scenario-2-answer" class="slide level2">
<h2>Scenario 2 – Answer</h2>
<p><br><br> <span style="color: red;"><strong>M/M/1 Queueing Model</strong></span><br>
<br></p>
<ul>
<li>One nurse = one server<br>
</li>
<li>Unlimited queue = no blocking<br>
</li>
<li>Standard basic queueing setup</li>
</ul>
</section>
<section id="scenario-3" class="slide level2">
<h2>Scenario 3</h2>
<p>A city hospital’s diagnostic laboratory operates with four technicians. Incoming test samples are processed as soon as a technician is free. If all are busy, samples wait in a queue with no limit.</p>
<p>Which model applies?</p>
<ul>
<li>M/M/1<br>
</li>
<li>M/M/s<br>
</li>
<li>M/M/s/b</li>
</ul>
<button id="timer-btn-3" onclick="startTimer('timer-btn-3', 30)" style="
  position: absolute;
  bottom: 1em;
  right: 2em;
  padding: 12px 18px;
  font-size: 1.2em;
  font-weight: bold;
  border-radius: 8px;
  border: 2px solid #ccc;
  background-color: #f9f9f9;
  color: #333;
  font-family: monospace;
">
⏳ 00:30
</button>
</section>
<section id="scenario-3-answer" class="slide level2">
<h2>Scenario 3 – Answer</h2>
<p><br><br> <span style="color: red;"><strong>M/M/s Queueing Model</strong></span></p>
<ul>
<li>Four technicians = multiple servers<br>
</li>
<li>Queue allowed = no blocking<br>
</li>
<li>Standard multi-server queue</li>
</ul>
</section></section>
<section>
<section id="outline-3" class="title-slide slide level1 center">
<h1><span style="color: black;">Outline</span></h1>
<ol type="1">
<li>Recap</li>
<li>Continuous Time Markov Chains (CTMC)</li>
<li>Queueing Theory</li>
<li><span style="color: red;">Lab Activity: Vaccine Clinic Operations</span></li>
</ol>
</section>
<section id="lab-activity-vaccine-clinic-operations" class="slide level2">
<h2>Lab Activity: Vaccine Clinic Operations</h2>
<p>In this hands-on session, you’ll use R code to explore how Continuous-Time Markov Chains (CTMCs) and Queueing Theory help us understand operations at a rural vaccine clinic.</p>
<p>We’ll work through:</p>
<ul>
<li>A <strong>CTMC</strong> model for an observation room with limited space</li>
<li>An <strong>M/M/1 queue</strong> for a check-in desk staffed by one nurse</li>
<li>Scenario analysis and steady-state evaluation</li>
</ul>
<blockquote>
<p>Make sure R and the necessary libraries are ready (e.g., <code>Matrix</code>, <code>expm</code>).</p>
</blockquote>
<p>You’ll be guided with real-world tasks followed by code. Let’s begin!</p>
</section>
<section class="slide level2">


<img data-src="images/yourturn.png" class="r-stretch"><button id="timer-btn-4" onclick="startTimer('timer-btn-4', 900)" style="
  position: absolute;
  bottom: 1em;
  right: 2em;
  padding: 12px 18px;
  font-size: 1.2em;
  font-weight: bold;
  border-radius: 8px;
  border: 2px solid #ccc;
  background-color: #f9f9f9;
  color: #333;
  font-family: monospace;
">
⏳ 15:00
</button>
</section>
<section class="slide level2">


<img data-src="images/thankyou.png" class="quarto-figure quarto-figure-center r-stretch"></section>
<section class="slide level2">




<img data-src="images/dl4sg_qr.png" class="quarto-figure quarto-figure-center r-stretch"></section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="images/cardiff_dl4sg_logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>© 2025 Udeshi Salgado – DL4SG, Cardiff University</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/udeshisalgado\.github\.io");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>